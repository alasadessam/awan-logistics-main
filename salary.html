<script>
window.onload = function () {
    const iqama = localStorage.getItem("iqama");
    const pin = localStorage.getItem("pin");

    if (!iqama || !pin) {
        document.getElementById("salaryCard").innerHTML = "<p>Error: Missing login data.</p>";
        return;
    }

    fetch("https://script.google.com/macros/s/AKfycbyynTfR7VNf3I2ScW9Ptdg7XVZWcRh9CiCNM6MFEUAk_Gd5TVmS2IyHTygBcuVpPtVnrg/exec", {
        method: "POST",
        body: JSON.stringify({ iqama: iqama, pin: pin })
    })
    .then(res => res.json())
    .then(data => {

        if (data.status === "error") {
            document.getElementById("salaryCard").innerHTML = "<p>Invalid Iqama or PIN.</p>";
            return;
        }

        document.getElementById("salaryCard").innerHTML = `
            <div class="card-section">
                <h2>Employee Information</h2>
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>Iqama:</strong> ${data.iqama}</p>
            </div>

            <div class="card-section">
                <h2>Performance</h2>
                <p><strong>Total Orders:</strong> ${data.total_orders}</p>
                <p><strong>Order Price:</strong> ${data.order_price} SAR</p>
                <p><strong>Total KM:</strong> ${data.total_km}</p>
                <p><strong>KM Price:</strong> ${data.km_price} SAR</p>
                <p><strong>Target:</strong> ${data.target}</p>
            </div>

            <div class="card-section">
                <h2>Salary Details</h2>
                <p><strong>Total Salary:</strong> ${data.total_salary} SAR</p>
                <p><strong>Bonus:</strong> ${data.bonus} SAR</p>
                <p><strong>Hunger/Other Deduction:</strong> ${data.hunger_deduction} SAR</p>
                <p><strong>Wallet Deduction:</strong> ${data.wallet_deduction} SAR</p>
                <p><strong>Petrol Deduction:</strong> ${data.petrol_deduction} SAR</p>
                <p><strong>Awan Deduction:</strong> ${data.awan_deduction} SAR</p>
                <p><strong>Last Salary:</strong> ${data.last_salary} SAR</p>
            </div>

            <div class="card-section">
                <h2>Notes</h2>
                <p>${data.notes}</p>
            </div>
        `;
    });
}
</script>